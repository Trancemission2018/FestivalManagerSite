webpackJsonp([1],{"+uXx":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app","data-app":""}},[e("router-view")],1)},staticRenderFns:[]};var r=a("VU/8")({name:"App",data:function(){return{bottomNav:"recent"}}},o,!1,function(t){a("xZev")},null,null).exports,i=a("/ocq"),s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-btn",{attrs:{slot:"activator",color:"primary",dark:""},slot:"activator"},[t._v("Open Dialog")]),t._v(" "),a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("Use Google's location service?")]),t._v(" "),a("v-card-text",[t._v("Let Google help apps determine location. This means sending anonymous location data to Google, even when no apps are running.")]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"green darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Disagree")]),t._v(" "),a("v-btn",{attrs:{color:"green darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Agree")])],1)],1)],1)},staticRenderFns:[]};var l={name:"layers-list",components:{DialogConfirm:a("VU/8")({name:"dialog-confirm",components:{},props:[],data:function(){return{dialog:!0}},created:function(){},methods:{}},s,!1,function(t){a("wl+l")},"data-v-04c93743",null).exports},props:[],data:function(){return{}},created:function(){},methods:{deleteLayer:function(t){confirm("Are you sure you wish to delete "+t.data.layerName+"?")&&this.$store.dispatch("deleteLayer",t).then(function(t){})}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{"grid-list-md":""}},t._l(t.$store.state.currentMap.layers,function(e,n){return a("v-layout",{key:n._id,class:{teal:e._id===t.$store.state.currentMap.activeLayerId},attrs:{row:"",wrap:"","align-center":""},on:{click:function(t){}}},[a("v-flex",{attrs:{xs1:""}},[a("v-icon",[t._v("directions_car")])],1),t._v(" "),a("v-flex",{attrs:{"xs-10":""}},[t._v("\n            "+t._s(e.data.layerName)+"\n        ")]),t._v(" "),a("v-flex",{attrs:{xs1:""}},[a("v-icon",{on:{click:function(a){t.deleteLayer(e)}}},[t._v("delete")])],1)],1)}))},staticRenderFns:[]};var d=a("VU/8")(l,c,!1,function(t){a("ZLDs")},"data-v-1d15d408",null).exports,u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("v-list",{attrs:{"two-line":""}},[t._l(t.$store.state.mapIcons,function(e,n){return[a("v-list-tile",{key:n,attrs:{avatar:""},on:{click:function(a){t.setIconUrl(e.url)}}},[a("v-list-tile-avatar",[a("img",{attrs:{src:e.url}})]),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s(e.name)}}),t._v(" "),a("v-list-tile-sub-title",{})],1)],1)]})],2),t._v(" "),a("v-layout",{staticClass:"pa-2"},[a("v-flex",{attrs:{xs8:""}},[a("v-text-field",{attrs:{label:"Name"},model:{value:t.layerName,callback:function(e){t.layerName=e},expression:"layerName"}})],1),t._v(" "),a("v-flex",{staticClass:"pt-4 ml-4",attrs:{xs4:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.activeColour,expression:"activeColour"}],attrs:{type:"color"},domProps:{value:t.activeColour},on:{input:function(e){e.target.composing||(t.activeColour=e.target.value)}}})])],1),t._v(" "),a("v-btn",{attrs:{small:""},on:{click:function(e){t.saveLayer()}}},[t._v(" Save")]),t._v(" "),a("v-btn",{attrs:{small:""},on:{click:function(e){t.cancelAddLayer()}}},[t._v(" Cancel")])],1)],1)},staticRenderFns:[]};var p=a("VU/8")({name:"layer-add",components:{},props:[],data:function(){return{layerName:"",activeColour:"#000000"}},mounted:function(){this.activeColour=this.$store.getters.activeTab.layerColour},methods:{setIconUrl:function(t){this.$store.dispatch("setIconUrl",t)}},watch:{layerName:function(t){this.$store.dispatch("setLayerName",t)},activeColour:function(t){this.$store.dispatch("setActiveColour",t)}}},u,!1,function(t){a("p2o+")},"data-v-529f6286",null).exports,v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-toolbar",{staticClass:"mt-2",attrs:{dense:""}},t._l(t.section.layerTypes,function(e,n){return a("v-btn",{key:n,attrs:{small:""},on:{click:function(a){t.addLayer(e.type)}}},[t._v("\n        Add "+t._s(e.name)+"\n    ")])}))},staticRenderFns:[]},m={name:"",components:{SectionAddButtons:a("VU/8")({name:"section-add-buttons",props:{section:{}}},v,!1,null,null,null).exports,LayerAdd:p,LayersList:d},props:["section"],mounted:function(){console.log("Hello section",this.section)},methods:{}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",{attrs:{color:"grey lighten-4",flat:"",tile:""}},[a("section-add-buttons",{attrs:{section:t.section}}),t._v(" "),a("v-content",{staticClass:"pa-2 text-xs-left"},[t.$store.state.addingLayer.active?t._e():a("layers-list",{attrs:{section:t.section}}),t._v(" "),t.$store.state.addingLayer.active?a("layer-add"):t._e()],1)],1)],1)},staticRenderFns:[]},f=a("VU/8")(m,y,!1,null,null,null).exports,_={name:"",components:{LayerAdd:p,LayersList:d},props:[],mounted:function(){},methods:{}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",{attrs:{color:"grey lighten-4",flat:"",tile:""}},[a("v-toolbar",{staticClass:"mt-2",attrs:{dense:""}},[a("v-btn",{staticClass:"active",attrs:{small:""},on:{click:function(e){t.addLayer(1)}}},[t._v("\n                Add Route\n            ")]),t._v(" "),a("v-btn",{attrs:{small:""},on:{click:function(e){t.addLayer(2)}}},[t._v("\n                Add Car Park\n            ")]),t._v(" "),a("v-btn",{attrs:{small:""},on:{click:function(e){t.addLayer(3)}}},[t._v("\n                Add Entrance / Exit\n            ")])],1),t._v(" "),a("v-content",{staticClass:"pa-2 text-xs-left"},[t.$store.state.addingLayer.active?t._e():a("layers-list",{attrs:{section:"traffic"}}),t._v(" "),t.$store.state.addingLayer.active?a("layer-add"):t._e()],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(_,g,!1,function(t){a("+uXx")},"data-v-8b410e88",null).exports,T=a("mvHQ"),A=a.n(T),E=a("MdIv"),k={name:"main-map",components:{LMap:E.LMap,LTileLayer:E.LTileLayer,LMarker:E.LMarker,LPolyline:E.LPolyline,LPolygon:E.LPolygon,LTooltip:E.LTooltip,LPopup:E.LPopup,LIconDefault:E.LIconDefault},props:[],data:function(){return{tooltipOptions:{permanent:!0,direction:"center"},addedMarker:!1,glasto:{lat:51.15271479940974,lng:-2.6097464561462402},marker:{lat:51.15271479940974,lng:-2.6097464561462402}}},mounted:function(){var t=this;this.loadLayers().then(function(){t.$refs.mainMap.mapObject.eachLayer(function(t){})})},computed:{icon:function(){return L.icon({iconUrl:this.$store.state.addingLayer.iconUrl,iconSize:[40,40],iconAnchor:[20,20]})},mapHeight:function(){return"height: "+window.innerHeight+"px"},mapCentre:function(){if(localStorage.getItem("mapCentre")){var t=JSON.parse(localStorage.getItem("mapCentre"));return L.latLng(t.lat,t.lng)}},currentZoom:function(){if(localStorage.getItem("mapZoom"))return JSON.parse(localStorage.getItem("mapZoom"))},iconTest:function(){return L.icon({iconUrl:"https://avatars0.githubusercontent.com/u/3602272?s=88&v=4",iconSize:[40,40],iconAnchor:[20,20]})}},methods:{iconFromUrl:function(t){return L.icon({iconUrl:t,iconSize:[40,40],iconAnchor:[20,20]})},selectLayer:function(t){t.data.draggable=!0,this.$store.dispatch("setActiveLayer",t._id)},polygonCentre:function(t){},undoPoint:function(t){this.$store.dispatch("undoPointToLayer",t.latlng)},mapClick:function(t){switch(this.$store.state.addingLayer.layerType){case"marker":this.$store.dispatch("setMarkerPoint",t.latlng);break;default:switch(this.$store.state.addingLayer.active){case!0:this.$store.dispatch("addPointToLayer",t.latlng)}}},dragEnd:function(t){this.$store.dispatch("setMarkerPoint",t.target._latlng)},downloadData:function(){var t=A()(this.$store.state),e="data:application/json;charset=utf-8,"+encodeURIComponent(t),a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download","data.json"),a.innerHTML="Click Here to download",document.body.appendChild(a),a.click(),a.remove()}},watch:{"$store.state.addingLayer.active":function(){switch(this.$store.state.addingLayer.active){case!0:L.DomUtil.addClass(this.$refs.mainMap.mapObject._container,"crosshair-cursor-enabled");break;case!1:L.DomUtil.removeClass(this.$refs.mainMap.mapObject._container,"crosshair-cursor-enabled")}}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"esc",27,e.key,"Escape")?t.undoPoint(e):null}}},[a("v-toolbar",{attrs:{light:""}},[a("v-toolbar-side-icon"),t._v(" "),a("v-toolbar-title",{staticClass:"black--text"},[t._v("Festival Manager")]),t._v(" "),a("v-spacer"),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:t.saveMap}},[a("v-icon",[t._v("save")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:t.downloadData}},[a("v-icon",[t._v("cloud_download")])],1),t._v(" "),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("refresh")])],1),t._v(" "),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("more_vert")])],1)],1),t._v(" "),a("l-map",{ref:"mainMap",style:t.mapHeight,attrs:{zoom:14,center:t.$store.state.glasto},on:{click:t.mapClick}},[a("l-tile-layer",{attrs:{url:t.$store.state.currentMap.tileUrlSat}}),t._v(" "),"polyline"===t.$store.state.addingLayer.layerType?a("l-polyline",{attrs:{"lat-lngs":t.$store.state.addingLayer.points,color:t.$store.state.addingLayer.colour}}):t._e(),t._v(" "),"polygon"===t.$store.state.addingLayer.layerType?a("l-polygon",{attrs:{"lat-lngs":t.$store.state.addingLayer.points,color:t.$store.state.addingLayer.colour,fillColor:t.$store.state.addingLayer.colour}}):t._e(),t._v(" "),"marker"===t.$store.state.addingLayer.layerType?a("l-marker",{attrs:{"lat-lng":t.$store.state.addingLayer.markerPoint,draggable:!0,icon:t.icon},on:{dragend:t.dragEnd}},[a("l-tooltip",{attrs:{content:"<div class='markerLabel'>"+t.$store.state.addingLayer.layerName+"</div>",options:t.tooltipOptions}})],1):t._e(),t._v(" "),t._l(t.$store.getters.polygons,function(e){return a("l-polygon",{key:e._id,attrs:{"lat-lngs":e.data.points,color:e.data.colour,fillColor:e.data.colour,weight:3},on:{click:function(a){t.selectLayer(e)}}},[e.data.points.length>3?a("l-tooltip",{attrs:{icontent:"<i class='fas fa-car fa-3x'></i><br />"+e.data.layerName,content:""+e.data.layerName,options:t.tooltipOptions}}):t._e()],1)}),t._v(" "),t._l(t.$store.getters.polylines,function(e){return a("l-polyline",{key:e._id,attrs:{"lat-lngs":e.data.points,color:e.data.colour,fillColor:e.data.colour,weight:1},on:{click:function(a){t.selectLayer(e)}}},[e.data.points.length>2?a("l-tooltip",{attrs:{content:e.data.layerName,options:t.tooltipOptions}}):t._e()],1)}),t._v(" "),t._l(t.$store.getters.markers,function(e){return a("l-marker",{key:e._id,attrs:{"lat-lng":e.data.markerPoint,draggable:e.data.draggable,icon:t.iconFromUrl(e.data.iconUrl)},on:{click:function(a){t.selectLayer(e)}}},[a("l-tooltip",{attrs:{content:"<div class='markerLabel'>"+e.data.layerName+"</div>",options:t.tooltipOptions}})],1)})],2)],1)},staticRenderFns:[]};var C={name:"example",components:{MainMap:a("VU/8")(k,b,!1,function(t){a("UiIG")},null,null).exports,Security:f,Traffic:h},data:function(){return{activeTab:null}},watch:{activeTab:function(){this.$store.dispatch("setActiveSection",this.activeTab)}},methods:{saveAll:function(){this.$refs.mainMap.mapObject.eachLayer(function(t){console.log("Please save this layer",t)})}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{fluid:""}},[a("v-layout",[a("v-flex",{staticClass:"text-xs-center",attrs:{xs8:""}},[a("main-map")],1),t._v(" "),a("v-flex",{staticClass:"pa-2"},[a("v-tabs",{attrs:{color:"white",dark:"","slider-color":"blue"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[t._l(t.$store.state.sections,function(e){return a("v-tab",{key:e.name,attrs:{ripple:""}},[t._v("\n                    "+t._s(e.name)+"\n                ")])}),t._v(" "),t._l(t.$store.state.sections,function(t){return a("v-tab-item",{key:t.name},[a("v-card",{attrs:{flat:""}},[a(t.component,{tag:"component",attrs:{section:t}})],1)],1)})],2)],1)],1),t._v(" "),a("v-layout",[a("v-flex",[a("v-btn",{on:{click:t.saveAll}},[t._v("Save All")])],1)],1)],1)},staticRenderFns:[]},$=a("VU/8")(C,S,!1,null,null,null).exports;n.default.use(i.a);var x=new i.a({routes:[{path:"/",name:"MainMap",component:$}]}),N=a("NYxO"),I=a("mtWM"),M=(a.n(I).a.create({baseURL:"http://localhost:6969/",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}}),{setActiveSection:function(t,e){this.commit("SET_ACTIVE_TAB",e),this.commit("SET_SECTION",e),this.commit("SET_ACTIVE_SECTION",e)},setAddingLayer:function(){this.commit("SET_ADDING_LAYER")},cancelAddingLayer:function(){this.commit("CANCEL_ADDING_LAYER")},setAddingLayerType:function(t,e){this.commit("SET_ADDING_LAYER_TYPE",e)},addPointToLayer:function(t,e){this.commit("ADD_POINT_TO_LAYER",e)},setMarkerPoint:function(t,e){this.commit("SET_MARKER_POINT",e)},undoPointToLayer:function(t){this.commit("UNDO_POINT_TO_LAYER")},setActiveColour:function(t,e){this.commit("SET_ACTIVE_COLOUR",e)},setLayerName:function(t,e){this.commit("SET_LAYER_NAME",e)},setIconUrl:function(t,e){this.commit("SET_ICON_URL",e)},setActiveLayer:function(t,e){console.log("Setting layer",e),this.commit("SET_ACTIVE_LAYER",e)},loadLayers:function(){var t=localStorage.getItem("layers"),e=[];t&&(e=JSON.parse(t)),this.commit("ADD_LAYERS_TO_MAP",e)},saveLayer:function(t,e){t.context;var a=t.dispatch,n=localStorage.getItem("layers"),o=[];n&&(o=JSON.parse(n)),o.push({_id:Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,16),data:e}),localStorage.setItem("layers",A()(o)),a("loadLayers")},deleteLayer:function(t,e){t.context;var a=t.dispatch,n=JSON.parse(localStorage.getItem("layers")),o=[];n&&(o=n.filter(function(t){return t._id!==e._id})),localStorage.setItem("layers",A()(o)),a("loadLayers")}});n.default.use(N.a);var O=new N.a.Store({state:{currentMap:{position:{lat:0,long:0},tileUrl:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",tileUrlOSM:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",tileUrlSat:"http://mt0.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",zoom:5,lines:[],layers:[],activeLayerId:""},glasto:{lat:51.15271479940974,lng:-2.6097464561462402},addingLayer:{active:!1,section:2,layerType:null,layerName:"",points:[],iconUrl:"https://image.flaticon.com/icons/svg/1051/1051093.svg",markerPoint:{lat:51.15271479940974,lng:-2.6097464561462402},colour:"#000000",draggable:!1},layerTypes:[{id:1,type:"Line",component:"polyline"},{id:2,type:"Area",component:"polygon"},{id:3,type:"Marker",component:"marker"}],sections:[{name:"Security",component:"security",layerColour:"#000000",layerTypes:[{type:"polyline",name:"Fence",colour:"#000000"},{type:"polygon",name:"Zone",colour:"#000000"},{type:"marker",name:"Checkpoint",colour:"#000000"}]},{name:"Traffic",component:"traffic",layerColour:"#FFEE58",layerTypes:[{type:"polyline",name:"Route",colour:"#000000"},{type:"polygon",name:"Car Park",colour:"#000000"},{type:"marker",name:"Entrance / Exit",colour:"#000000"}]},{name:"Water",layerColour:"#03A9F4"},{name:"Electricity"},{name:"Stages"},{name:"Production"}],activeSection:0,mapIcons:[{name:"Stage",url:"https://image.flaticon.com/icons/svg/1051/1051093.svg"},{name:"Campsite",url:"https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Legenda_pole_namiotowe.svg/1000px-Legenda_pole_namiotowe.svg.png"}]},actions:M,mutations:{SET_ACTIVE_TAB:function(t,e){t.activeTab=e},SET_SECTION:function(t,e){t.addingLayer.section=e},SET_ACTIVE_SECTION:function(t,e){t.activeSection=e},SET_MAP_CENTRE:function(t,e){t.currentMap.position.lat=e.lat,t.currentMap.position.long=e.lng},SET_MAP_ZOOM:function(t,e){t.currentMap.zoom=e},SAVE_LINE:function(t,e){t.currentMap.lines.push(e)},SET_ADDING_LAYER:function(t){t.addingLayer.active=!0},CANCEL_ADDING_LAYER:function(t){t.addingLayer.active=!1,t.addingLayer.points=[]},SET_ADDING_LAYER_TYPE:function(t,e){t.addingLayer.layerType=e},ADD_POINT_TO_LAYER:function(t,e){t.addingLayer.points.push(e)},SET_MARKER_POINT:function(t,e){t.addingLayer.markerPoint=e},SET_ICON_URL:function(t,e){t.addingLayer.iconUrl=e},UNDO_POINT_TO_LAYER:function(t){t.addingLayer.points.pop()},SET_ACTIVE_COLOUR:function(t,e){t.addingLayer.colour=e},SET_LAYER_NAME:function(t,e){t.addingLayer.layerName=e},SET_ACTIVE_LAYER:function(t,e){t.currentMap.activeLayerId=e},ADD_LAYERS_TO_MAP:function(t,e){t.currentMap.layers=e}},getters:{activeTab:function(t){return t.sections[t.activeTab]},layerTypes:function(t){return t.layerTypes},layerType:function(t){return function(e){return t.layerTypes.find(function(t){return t.type===e})}},layersByType:function(t){return function(e){return t.currentMap.layers.filter(function(t){return t.type===e})}},polylines:function(t){return t.currentMap.layers.filter(function(t){return"polyline"===t.data.layerType})},polygons:function(t){return t.currentMap.layers.filter(function(t){return"polygon"===t.data.layerType})},markers:function(t){return t.currentMap.layers.filter(function(t){return"marker"===t.data.layerType})}}}),P=a("9JMe"),U=a("3EgV"),R=a.n(U),w={methods:{addLayer(t){console.log("And the layer type is ",t),this.$store.dispatch("setAddingLayer"),this.$store.dispatch("setAddingLayerType",t)},cancelAddLayer(){this.$store.dispatch("cancelAddingLayer")},saveLayer(){this.$store.dispatch("saveLayer",this.$store.state.addingLayer).then(()=>{this.loadLayers(),this.$store.dispatch("cancelAddingLayer")})},loadLayers(){return new Promise((t,e)=>{this.$store.dispatch("loadLayers").then(()=>t())})}}},D=a("u/jC"),V=a.n(D);Object(P.sync)(O,x),n.default.use(R.a),n.default.config.productionTip=!1,n.default.mixin(w),n.default.use(V.a),new n.default({el:"#app",router:x,store:O,components:{App:r},template:"<App/>"})},UiIG:function(t,e){},ZLDs:function(t,e){},"p2o+":function(t,e){},"wl+l":function(t,e){},xZev:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.9933b3fe5861518c5f68.js.map